%h2 Shares

- if @tasks.present?
  %h3 Notifications
  .section
    %ul.tasks
      - @tasks.each do |task|
        = content_tag_for(:li, task) do
          = render :partial => 'tasks/task', :locals => {:task => task}

.section
  %p
    You currently hold:
    = pluralize(current_user.shares_count, "share")
    in
    = co.name + '.'
  %p
    The share value is
    = number_to_currency(co.share_value_in_pounds, :unit => "Â£")
  %p
    The minimum shareholding is
    = pluralize(co.minimum_shareholding, "share.", "shares.")
  - if co.interest_rate
    %p
      The rate of interest on share capital is
      = "#{co.interest_rate}%."

.section
  - if can?(:create, ShareApplication)
    = link_button("Apply for more shares", :url => new_share_application_path)
  %br.clear

- if @share_payments_pending.present?
  .section
    %h3 Payments pending for issued shares

- if @share_withdrawals_outstanding.present?
  .section
    %h3 Outstanding share withdrawals

- if can?(:read, ShareAccount)
  .section
    %h3 Share ownership
    %table.share_account_balances
      %thead
        %tr
          %th Member
          %th Shares
      %tbody
        - @members.each do |member|
          = content_tag_for(:tr, member) do
            %td= link_to(member.name, member_path(member))
            %td= member.find_or_build_share_account.balance

- if can?(:update, co)
  .section
    = link_button("Adjust share value", :url => edit_share_value_shares_path)
    = link_button("Adjust minimum shareholding", :url => edit_minimum_shareholding_shares_path)
    = link_button("Adjust interest rate", :url => edit_interest_rate_shares_path)
    %br.clear
